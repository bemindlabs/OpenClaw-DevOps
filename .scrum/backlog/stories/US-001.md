# US-001: Docker Compose Basic Stack

## Story Details

| Field | Value |
|-------|-------|
| **Story ID** | US-001 |
| **Epic** | EPIC-INFRA |
| **Title** | Docker Compose Basic Stack |
| **Priority** | Critical |
| **Story Points** | 5 |
| **Status** | Ready |
| **Assignee** | Unassigned |
| **Sprint** | Sprint 1 |

## User Story

**As a** DevOps engineer,
**I want** a Docker Compose configuration for the basic stack,
**So that** I can deploy the core services (Nginx, Landing, Gateway, Assistant) with a single command.

## Description

Create and configure the `docker-compose.yml` file to orchestrate the basic stack of services including Nginx reverse proxy, Landing page, Gateway, and Assistant portal. The configuration should support both development and production environments with appropriate health checks and restart policies.

## Acceptance Criteria

- [ ] `docker-compose.yml` defines all four core services
- [ ] Each service has a health check configured
- [ ] Environment variables loaded from `.env` file
- [ ] Services restart automatically on failure (`unless-stopped`)
- [ ] Ports exposed correctly: 80/443 (nginx), 3000 (landing), 18789 (gateway), 5555 (assistant)
- [ ] Volume mounts configured for persistent data
- [ ] All services start successfully with `docker-compose up -d`
- [ ] Services are healthy within 60 seconds of start

## Technical Notes

### IEEE Requirement References
- IEEE-STD-INFRA-001: Container Orchestration

### Implementation Details

```yaml
# Key service configuration
services:
  nginx:
    image: nginx:alpine
    ports: ["80:80", "443:443"]
    depends_on: [landing, gateway]

  landing:
    image: openclaw-landing:latest
    ports: ["3000:3000"]

  gateway:
    image: openclaw-gateway:latest
    ports: ["18789:18789"]

  assistant:
    image: openclaw-assistant:latest
    ports: ["5555:5555"]
    depends_on: [gateway]
```

### Health Check Configuration
- Start period: 40 seconds
- Interval: 30 seconds
- Timeout: 10 seconds
- Retries: 3

### Files to Create/Modify
- `docker-compose.yml`
- `.env.example`

## Dependencies

- Docker images built for all services
- `.env` file created with required variables
- Nginx configuration files in place

## Definition of Done

- [ ] Code complete and tested locally
- [ ] All services start without errors
- [ ] Health checks pass for all services
- [ ] Documentation updated in CLAUDE.md
- [ ] PR reviewed and merged

---

*Created: 2026-02-08*
